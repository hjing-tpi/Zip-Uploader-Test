#Parse build data passed in and populate IDs, options and part numbers
#This Script is expected to set the out parameters below
#
#TPass Objects Passed In/Returned
#   in - string "RunTestCycleId" - Id passed into the RunTestCycle() method
#   in - string "BuildData" - Build data sent from the option retrieval script
#   in  - object "MainTPassScripting" - Exposed methods and properties for the scripts to use
#   in  - method "TPassLogger" - This is the logging method to log to the main TPass log file
#   in  - method "TestAppLogger" - This is the logging method to log to the TPass Test Application log file
#   in  - method "GetConfigurationValue" - This is the method to get values set in the System Configuration file
#   out - string "primaryId"
#   out - string "secondaryId"
#   out - string "tertiaryId"
#   out - string "quaternaryId"
#   out - string "quinaryId"
#   out - list<string> "OptionCodesInBuildData"
#   out - dictionary<string,string> "PartNumbers"
#   out - bool "isSuccess"
#   out - bool "production"
#   out - string "version"
#

from System.Text.RegularExpressions import Regex

production = False
version = "2.0"

#########################################################################################################################################
# Application Engineer:  Set Part Number Tag Names required for Test Application and the Test Application Script File Name
#
partNumberTags = set(["IPC","TCM","AMP","SDM","UPA","AOS","FCM","VPM","BCM","CGM","CSM","ONS","SIB","DTC","HFP","RAD","PEPS","HVAC"])
#
#########################################################################################################################################

try:

    primaryId = ""
    secondaryId = ""
    tertiaryId = ""
    quaternaryId = ""
    quinaryId = ""
    TPassLogger.Debug("Option Parsing Script:  Product Id = {0}", RunTestCycleId)
    TPassLogger.Debug("Option Parsing Script:  Product Build Data = {0}", BuildData)
    #BuildData = "30455,PVIF=201005706,GEPICSPVI=201005706,GEPICSCSN=1PP0456130 ,GEPICSSKCODETYPE=DataProcessingNumber,GEPICSVIN=1G1Y72D46L5105617,GEPICSPONO=XMMK8R,GEPICSIDENT=005706,PVI=005706,VIN=1G1Y72D46L5105617,MDYR=L,CSN=1PP0456130 ,ASSM=1,PDYR=2020,MD=  1YC07,RP01=0ST,RP02=1SZ,RP03=2LT,RP04=2ST,RP05=3F9,RP06=3ST,RP07=4JF,RP08=4ST,RP09=5A7,RP10=5FC,RP11=5ST,RP12=6X1,RP13=7X1,RP14=8X2,RP15=9L3,RP16=9X2,RP17=A2X,RP18=A7K,RP19=AH2,RP20=AHE,RP21=AHH,RP22=AJ7,RP23=AL0,RP24=AL9,RP25=AP9,RP26=AQA,RP27=AT9,RP28=AXJ,RP29=BGR,RP30=CC3,RP31=CJ2,RP32=DRZ,RP33=DYX,RP34=E2C,RP35=EF7,RP36=EFR,RP37=EPH,RP38=EYT,RP39=FE1,RP40=FE9,RP41=FJW,RP42=G0J,RP43=GMO,RP44=HUK,RP45=I20,RP46=IOT,RP47=J6F,RP48=JL9,RP49=K4C,RP50=KI3,RP51=KQV,RP52=KRV,RP53=LHD,RP54=LT2,RP55=M1L,RP56=MAH,RP57=N38,RP58=NE8,RP59=NK4,RP60=NKD,RP61=NPP,RP62=NTB,RP63=NWI,RP64=Q8P,RP65=R9N,RP66=RWL,RP67=SLL,RP68=T4L,RP69=TB8,RP70=TDM,RP71=TTW,RP72=U2K,RP73=U2L,RP74=U80,RP75=UD7,RP76=UDV,RP77=UE1,RP78=UFG,RP79=UFT,RP80=UG1,RP81=UJN,RP82=UMN,RP83=UQH,RP84=UQT,RP85=UQV,RP86=UTJ,RP87=UTU,RP88=UTV,RP89=UV6,RP90=UVA,RP91=V8D,RP92=VA5,RP93=VH9,RP94=VHM,RP95=VRF,RP96=VRG,RP97=VRH,RP98=VRK,RP99=VRL,RP100=VRM,RP101=VRN,RP102=VRR,RP103=VT7,RP104=VV4,RP105=W5Y,RP106=WML,RP107=XFN,RP108=XL8,RP109=Y8C,RP110=   ,RP111=   ,RP112=   ,RP113=   ,RP114=   ,RP115=   ,RP116=   ,RP117=   ,RP118=   ,RP119=   ,RP120=   ,RP121=   ,RP122=   ,RP123=   ,RP124=   ,RP125=   ,RP126=   ,RP127=   ,RP128=   ,RP129=   ,RP130=   ,RP131=   ,RP132=   ,RP133=   ,RP134=   ,RP135=   ,RP136=   ,RP137=   ,RP138=   ,RP139=   ,RP140=   ,RP141=   ,RP142=   ,RP143=   ,RP144=   ,RP145=   ,RP146=   ,RP147=   ,RP148=   ,RP149=   ,RP150=   ,RP151=   ,RP152=   ,RP153=   ,RP154=   ,RP155=   ,RP156=   ,RP157=   ,RP158=   ,RP159=   ,RP160=   ,RP161=   ,RP162=   ,RP163=   ,RP164=   ,RP165=   ,RP166=   ,RP167=   ,RP168=   ,RP169=   ,RP170=   ,RP171=   ,RP172=   ,RP173=   ,RP174=   ,RP175=   ,RP176=   ,RP177=   ,RP178=   ,RP179=   ,RP180=   ,RP181=   ,RP182=   ,RP183=   ,RP184=   ,RP185=   ,RP186=   ,RP187=   ,RP188=   ,RP189=   ,RP190=   ,RP191=   ,RP192=   ,RP193=   ,RP194=   ,RP195=   ,RP196=   ,RP197=   ,RP198=   ,RP199=   ,RP200=   ,RP201=   ,RP202=   ,RP203=   ,RP204=   ,RP205=   ,RP206=   ,RP207=   ,RP208=   ,RP209=   ,RP210=   ,RP211=   ,RP212=   ,RP213=   ,RP214=   ,RP215=   ,RP216=   ,RP217=   ,RP218=   ,RP219=   ,RP220=   ,RP221=   ,RP222=   ,RP223=   ,RP224=   ,RP225=   ,RP226=   ,RP227=   ,RP228=   ,RP229=   ,RP230=   ,RP231=   ,RP232=   ,RP233=   ,RP234=   ,RP235=   ,RP236=   ,RP237=   ,RP238=   ,RP239=   ,RP240=   ,RP241=   ,RP242=   ,RP243=   ,RP244=   ,RP245=   ,RP246=   ,RP247=   ,RP248=   ,RP249=   ,RP250=   ,ECMBC=    ,ECM=12710957,ESC=        ,BPC=        ,SGC=        ,ARB=        ,HUD=        ,RPD=        ,HUDUTIL=          ,HUDOPSOFT=          ,HUDCALN=          ,FSC=----****,FICM=----****,ICCM=----****,FSCUTIL=----****__,FICMUTIL=----****__,ICCMUTIL=----****__,FSCOPSOFT=----****__,FICMOPSOFT=----****__,ICCMOPSOFT=----****__,FSCFUELRAIL=----****__,ICCMCAL=----****__,FICMCAL=----****__,FSCSYSTEM=----****__,ICCMSYSTEM=----****__,GPM=        ,ITB=        ,PTO=        ,RSM=        ,HVM=        ,LSS=        ,ATC=        ,ELSD=        ,IPC=84934657,ECMUTIL=12710209__,ECMOPSOFT=12711395__,ECMENGINE=12712068__,ECMFUEL=12708587__,ECMSYSTEM=12712110__,ECMSPEED=12706631__,ECMTRANS=          ,ECMINTERNAL=          ,ECMENGDIAG=12710623__,ECMTRANSDIAG=          ,BCM=13534861,BCMUTIL=13509073__,AHB=        ,FOH=        ,CHCM=        ,BCMLIGHT=          ,RCC=        ,BCMTHEFT=84928925__,RTD=----****,SADS=----****,RTDUTIL=----****__,SADSUTIL=----****__,RTDCALN=----****__,SADSCALN=----****__,VASTHOLD= ,STATICHOLD= ,FLASHHOLD= ,ALIGNHOLD= ,IRC=84922768,IRCUTIL=84666747__,IRCCALN=84577938__,TCM=24298372,TCMUTIL=24298374__,TCMOPSOFT=24044257__,TCMCALN=24044259__,RSA=        ,ECMMPUSW=          ,BCMOPSOFT=13539141__,ATCUTIL=----****__,ELSDUTIL=----****__,ATCOPSOFT=          ,ELSDOPSOFT=          ,ATCCALN=----****__,ELSDCALN=----****__,IPCUTIL=84307007__,IPCOPSOFT=84934658__,IPCCALN=          ,DDM=        ,DDMUTIL=          ,DDMOPSOFT=          ,PDM=        ,PDMUTIL=          ,PDMOPSOFT=          ,DDMSYSTEM=          ,PDMSYSTEM=          ,DDMBRAND=          ,PDMBRAND=          ,LGM=----****,FTC=----****,CRC=----****,MTCM=----****,MRCM=----****,LGMUTIL=----****__,FTCUTIL=----****__,CRCUTIL=----****__,LGMOPSOFT=----****__,CRCOPSOFT=----****__,FTCOPSOFT=----****__,MTCMOPSOFT=----****__,MRCMOPSOFT=----****__,LGMSYSTEM=----****__,FTCCALN=----****__,MTCMCALN=----****__,MRCMCALN=----****__,RTDOPSOFT=----****__,SADSOPSOFT=----****__,BCMACCSRY=          ,BCMSYSTEM=84981796__,BCMLOCKING=84941875__,SDIV=13,PNTU=GMO,FSON=      ,DLRC=26495,ONS=84894695,VLBS=84894695,ERA=84894695,TCP=84894695,ONSUTIL=84963660__,TCPUTIL=84963660__,VLBSUTIL=84963660__,ONSCALN=          ,SDG=13540081,CGM=13540081,CGM2=13540081,SDGUTIL=13522139__,CGMUTIL=13522139__,SDGUTIL=13522139__,SDGOPSOFT=13541547__,CGMOPSOFT=13541547__,SDGOPSOFT=13541547__,SDGCALN=13540760__,CGMCALN=13540760__,SDGCALN=13540760__,IRCOPSOFT=84922782__,IRCTUNER=----****__,IRCAUDIO=----****__,IRCEQLZR=84577961__,IRCSYSTEM=----****__,ECC=----****,ECCUTIL=          ,ECCAIRFLOW=----****__,AMP=84825168,AMPUTIL=84565382__,AMPCALN=84826585__,EBC=----****,EBCUTIL=84898406__,EBCOPSOFT=84910604__,EBCCALN=84910605__,RANDOM=4038,RSE=        ,RSEUTIL=          ,RSECALN=          ,ECMENGCOMM=          ,TPMTIRERF=         ,TPMTIRELF=         ,TPMTIRERR=         ,TPMTIRELR=         ,TPMTIRESP=        2,TPMTIRETYPE=245/35ZR19  ,TPMPLCRDF=30,TPMPLCRDR=30,TPMPLCRDS=00,SDRUTIL=          ,RVC=        ,RVCUTIL=          ,RVCOPSOFT=          ,RVCCALN=          ,TCMTRANS=----****__,TCMDIAG=----****__,TCMSYSTEM=----****__,ECMMPUCALN=          ,TVM=        ,BC2=        ,BC2UTIL=          ,BC2OPSOFT=          ,BC2CALN=          ,EPS=84893268,EPSUTIL=84654666__,EPSOPSOFT=84888069__,EPSCALN=84893271__,IRCLANGUAGE=84943281__,IRCCAMERA=84577946__,IRCILLUMIN=----****__,IRCDIGITAL=          ,IRCNAVI=          ,CHM=        ,CLM=----****,SCL=----****,EFM=        ,EKM=        ,KEYFOBPN=        ,IMMO=        ,ROS=        ,ITBUTIL=          ,ITBOPSOFT=          ,EPSSYSCAL2=84696791__,ITBAPPCALN=          ,CQISHOLD= ,SECVASTHOLD= ,TPMHOLD= ,HOLDTBD2= ,BCMCHARGE=84922132__,BCMWIPER=84879688__,BCMHVAC=----****__,BCMPWRTRN=----****__,BCMCHASSIS=84903096__,BCMDRIVE=          ,ECCOPSOFT=----****__,ECCSYSTEM=----****__,IRCDSPSOFT=----****__,IRCCONTROL=----****__,ACCA=        ,ACC=        ,LRR=        ,RFA=        ,RFAUTIL=          ,RFAOPSOFT=          ,RFAOPSOFTHG=          ,RFACALN=          ,SDM=13537504,SDMUTIL=13536180__,SDMOPSOFT=13540614__,SDMSYSTEM=84835535__,SDR=        ,UPA=84854151,UPAUTIL=84353978__,UPAOPSOFT=84854153__,UPACALN=84859623__,VTD=        ,VTDUTIL=          ,VTDOPSOFT=          ,VTDCALN=          ,DDMACCSRY=          ,PDMACCSRY=          ,AOS=84871964,MSM=13535048,MSMUTIL=84939225__,MSMOPSOFT=13541399__,MSMCALN=13539012__,AC2=        ,ACM=        ,ACCM=        ,AFL=        ,AFLUTIL=          ,AFLOPSOFT=          ,AFLCALN=          ,APM=        ,HCP=        ,HCPUTIL=          ,HCPOPSOFT=          ,HCPSYSTEM=          ,HCPDIAG=          ,HCPHYBRID=          ,HVMUTIL=          ,HVMOPSOFT=          ,HVMCALN=          ,FCM=        ,LDW=        ,LDWUTIL=          ,FCMUTIL=          ,LDWOPSOFT=          ,FCMOPSOFT=          ,LDWCALN=          ,FCMCALN=          ,APPS=        ,PPS=        ,SBZ=84718351,SBZL=84718351,SBZR=84718351,SDGSENSOR=          ,SDGSYSTEM=          ,AFS=        ,ICS=84858588,SCM=        ,IRCFACSW=          ,IRCFACEEP=          ,DEFCOPSOFT=          ,DEFCCALN=          ,DEFCUTIL=          ,DEFC=        ,SIC=----****,DIC=----****,SICXML=          ,DICDISPLAY=          ,SICOPSOFT=          ,DICSYSTEM=          ,SICCALN=          ,SICLANGUAGE=          ,SICILLUMIN=          ,SICSPORT=          ,SICUTIL=          ,DICUTIL=          ,RFAXML=          ,IPCSERVICE=          ,IPCFUEL=          ,IPCRPO=          ,NIM=        ,NIMUTIL=          ,NIMCAL=          ,SIM=        ,ONSVOICE=          ,ONSOPSOFT=          ,ONSINFO=          ,ONSSYSTEM=          ,KEYCODE=     ,ALC=----****,EPB=----****,EPBUTIL=----****__,EPBOPSOFT=----****__,EPBCALN=----****__,EPBXML=          ,BCMXML=          ,MCPAUTIL=          ,MCPAOPSOFT=          ,MCPAMOTOR=          ,MCPADIAG=          ,BECM=        ,HCPBATTERY=          ,RANDOM2=    ,TCCMBCAL= ,AHBUTIL=          ,AHBOPSOFT=          ,AHBCALN=          ,AHBXML=          ,ONSVOCAB=          ,AFLAPP=          ,AFLXML=          ,ALCUTIL=----****__,ALCOPSOFT=----****__,ALCCALN=----****__,ALCXML=          ,ATCXML=          ,BCMDISPLAY=84925774__,BCMLAMPAUTO=----****__,BCMLAMPMAN=----****__,BCMRDOINFO=84546452__,BCMAUXALARM=84536339__,BCMWINDOW1=          ,BCMWINDOW2=          ,BCMWINDOW3=          ,BCMWINDOW4=          ,BCMSUNROOF=84710247__,BCMSUNSHADE=----****__,EBCDRIVELINE=          ,EBCBRAKE=          ,EBCPWRTRN=          ,EBCBODYSTYLE=          ,EBCDRIVER=84910616__,EBCXML=          ,IMU=        ,6DOFIMU1=        ,IMUXML=          ,IPCHMI=          ,IPCGRAPHIC=          ,IPCLANGUAGE=          ,IPCPERF=----****__,IPCLIGHTING=----****__,IPCINDICATOR=84832156__,IPCWARNING=----****__,IPCTRANS=----****__,IPCSPDBIAS=----****__,IPCAIRTEMP=----****__,IPCBACKGRND=          ,IPCXML=----****__,IRCBRAND=84943277__,IRCFONT=          ,PDI=        ,PDIUTIL=          ,PDIOPSOFT=          ,PDICALN=          ,PEPS=----****,PEPSUTIL=----****__,PEPSOPSOFT=----****__,PEPSPERF=----****__,PEPSANTENNA=----****__,SAS=        ,ECMBOOT=          ,SCLUTIL=----****__,SDMPERFM=          ,TCCMCLASS=          ,SDMSBIOFF=84854326__,SDROPSOFT=          ,SDROPSOFT2=          ,SDRCALN=          ,TIM=        ,TIMXML=          ,UHP=        ,UHPUTIL=          ,UHPOPSOFT=          ,UHPLANGSOFT=          ,UHPTUNING=          ,UHPSYSTEM=          ,UHPACCSOFT=          ,UPAXML=          ,SICPRGM=          ,DICPRGM=          ,EFP=84873340,HFP=84873340,HFPF=84873340,VES=        ,VESUTIL=          ,VESOPSOFT=          ,VESCALN=          ,CHMUTIL=          ,CHMOPSOFT=          ,CHMCALN=          ,BPCOPSOFT=          ,IPCDTCCAL=          ,ECMBLKOPSOFT=          ,ECMXML=          ,EBCBASE=        ,IPB=        ,IPBUTIL=          ,IPBOPSOFT=          ,IPBUCAPP5=          ,IPBUCAPP3=          ,IPBFPGASOFT=          ,IPBDSP1SOFT=          ,IPBDSP1APP1=          ,IPBDSP2SOFT=          ,IPBDSP2APP4=          ,IPBDSP2APP2=          ,ACCUTIL=          ,LRRUTIL=          ,ACCOPSOFT=          ,LRROPSOFT=          ,ACCSOFTCALN=          ,LRRCAL=          ,ACCSOFTSEN=          ,ACCXML=          ,EPSXML=----****__,EBCP2SOFT=          ,EBCP2CALN=          ,VIC=        ,VICUTIL=          ,VICOPSOFT=          ,VICCALN=          ,MCPBUTIL=          ,MCPBOPSOFT=          ,MCPBMOTOR=          ,MCPBDIAG=          ,ATPUTIL=          ,ATPOPSOFT=          ,ATPMOTOR=          ,ATPDIAG=          ,TIMOPSOFT=          ,BECMUTIL=          ,OBCM=        ,VICSECOP=          ,IMA=                                                                                                                                                                                                                                                                                                                                                                                                                ,IRCXML=          ,PWL=        ,HCPINTEG=        ,KEYFOBDATA=                                                                                                    ,K2XXFOB1=                                                  ,K2XXFOB2=                                                  ,LDWSYSCAL=          ,HMI=----****,HMIOPSOFT=          ,HMISYSTEM=----****__,HMIDISPLAY=----****__,HMIWIRELESS=----****__,HMINAVSYS=----****__,HMIGRAPHICS=----****__,HMIBRAND=----****__,HMICOUNTRY=----****__,HMISPEECH=----****__,HMITUNING=----****__,HMICAMERA=----****__,HMIUTIL=----****__,EOCM=        ,EOCMA=        ,EOCMUTIL=          ,EOCAK1UTIL=          ,EOCMOPSOFT1=          ,EOCAK1OPSOFT=          ,EOCMOPSOFT2=          ,EOCAK2OPSOFT=          ,EOCMMFG1=          ,EOCMMFG2=          ,EOCMSYSTEM1=          ,EOCAK1SYS=          ,EOCMSYSTEM2=          ,EOCAK2SYS=          ,EOCMBRK1=          ,EOCMBRK2=          ,EOCMPWRT1=          ,EOCMPWRT2=          ,EOCMDYN1=          ,EOCAK1DYN=          ,EOCMDYN2=          ,EOCAK2DYN=          ,EOCMCONFIG1=          ,EOCAK1CON=          ,EOCMCONFIG2=          ,EOCAK2CON=          ,EOCMACC=          ,EOCMLDW=          ,SRRLF=        ,SRRLR=        ,SRRRF=        ,SRRR=        ,SRRRR=        ,SRRC2LF=        ,RVM=84793408,RVMOPSOFT=          ,AMPOPSOFT=84825172__,SRRLFOPSOFT=          ,SRRLROPSOFT=          ,SRRRFOPSOFT=          ,SRRROPSOFT=          ,SRRRROPSOFT=          ,SRRC2OPSOFT=          ,SRRC2LFOP=          ,SRRLFCAL=          ,SRRRFCAL=          ,SRRC2CAL=          ,SRRRCAL=          ,SRRLRCAL=          ,SRRRRCAL=          ,SBZOPSOFT=84718353__,SBZLUTIL=84718355__,SBZRUTIL=84718356__,SBZPOS2CALR=          ,SBZPOS2CAL=84846457__,SBZPOS2CALL=84846457__,RSEOPSOFT=          ,RSELIGHTING=          ,RSESYSTEM=          ,RSEBRAND=          ,RSECOUNTRY=          ,RVMXML=          ,EPSMOT=84888072__,EPSSYSCAL=84888070__,ICCMDIAG=----****__,ICCMSPEED=----****__,ICCMP2OPSOFT=----****__,ICCMP2CALN=----****__,CCM2=        ,CCM2CALN=          ,CCM2OPSOFT=          ,CCM2UTIL=          ,CCM2DIAG=          ,CCM2SYS=          ,CCM2SPEED=          ,CCM2P2OPSOFT=          ,CCM2P2CAL=          ,SRRLFUTIL=          ,SRRC2LFUTIL=          ,SRRRFUTIL=          ,SRRC2RFUTIL=          ,SRRRUTIL=          ,SRRC2CRUTIL=          ,SRRRUTILL=          ,SRRLRUTIL=          ,ENGINENUMBER=                 ,REARTRIM=         ,CRCCALN=          ,CRCLAMP=          ,CRCTRAILER=          ,CRCSEATVENT=          ,CRCSEATADJR=          ,CRCSEATHTR=          ,CRCSSCONTRL=          ,CRCBELTASSI=          ,MSBLF=        ,MSBRF=        ,MSB=        ,ECOSHOLD= ,VISUALHOLD= ,DVTHOLD= ,SPARE1HOLD= ,SPARE2HOLD= ,HOLDTBD3= ,HOLDTBD4= ,HOLDTBD5= ,MSBOPSOFT=          ,MSBUTILL=          ,MSBUTILR=          ,MSBCALN=          ,CLUTCHSPEC=  ,TPMPLCRDF1=030,TPMPLCRDR1=030,TPMPLCRDF2=030,TPMPLCRDR2=030,TPMPLCRDF3=030,TPMPLCRDR3=030,ARBCALN=          ,ARBOPSOFT=          ,ARBUTIL=          ,LGMCALN1=          ,LGMCALN2=          ,CRCXML=          ,TCMSUBCPU=----****__,TCMMPUCALN=----****__,SRRRUTILR=          ,SRRRRUTIL=          ,IRCMANIFEST=          ,ICSUTIL=84803834__,EFPUTIL=84803837__,HFPFUTIL=84803837__,IRCBLUET=          ,IRCHANDFR=84577945__,PFAF=        ,PFAFOPSOFT=          ,PFAFUTIL=          ,PFAFXML=          ,PFAFCAL=          ,HPCC=        ,EBCDIAG=84910608__,EBCFUNC=84910612__,EBCDDS=          ,DCDC=        ,DCDCXML=          ,ACCCIBCAL=          ,LRRCALN2=          ,ACCLUTCAL=          ,TPD=        ,MFC=        ,PDR=84884494,DCAC=        ,ARS=        ,ARSOPSOFT=          ,ARSPERF=          ,ARSUTIL=          ,VPM=84901295,MSMP=13535048,MSMPUTILITY=84939226__,MSMPOPSOFT=13541399__,MSMPCAL=13539013__,TCMCHAR=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,TRANSCHAR=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ,TCMPUSP=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,TCMMOTOR=          ,LVM=        ,LVMUTIL=          ,LVMOPSOFT=          ,LVMHMICALN=          ,LVMCOUNTRY=          ,LVMBRAND=          ,LVMSYS=          ,LVMBUTTON=          ,LVMSPEECH=          ,LVMSIGN=          ,LVMLICENSE=          ,LVMMANIF=          ,GAFICM=----****,GAFICMOP=----****__,GAFICMUTIL=----****__,GAFICMCALN=          ,EBOOST=84774537,EBOOSTUTIL=          ,EBOOSTOPSOFT=          ,EBOOSTCALN=          ,RTDXML=          ,GAFICMDIAG=----****__,GAFICMENG=----****__,GAFICMFUEL=----****__,GAFICMVEH=----****__,GAFICMSPD=----****__,MCPPIMCAL=          ,PFAFMANCAL=          ,SRRPRIME=          ,SRRC2PRIME=          ,SRRSECCAL=          ,SRRC2SECCAL=          ,SRROPSOFT2=          ,SRRC2OPSOFT2=          ,ARSCAL=          ,VPMUTIL=84774208__,VPMOPSOFT2=84808595__,VPMSECCAL=84808596__,VPMOPSOFT=84901297__,VPMPROCESS=----****__,VPMTRIG=----****__,VPMTOP=----****__,VPMPEDEST=----****__,NVM=        ,MSMLR=        ,MSMRR=        ,MSMLRUTIL=          ,MSMRRUTIL=          ,MSMLROPSOFT=          ,MSMRROPSOFT=          ,MSMLRCAL=          ,MSMRRCAL=          ,TRCM=        ,TRCMUTIL=          ,TRCMOPSOFT=          ,TRCMCALN=          ,ONSXML=          ,NVMOPSOFT=          ,NVMUTIL=          ,NVMCALN=          ,EBCEPBCAL=84910624__,SENDER2SEQ=       ,6DOFIMU2=        ,CGMSEC=13538844__,GAFICMXML=          ,FCMXML=          ,LDWXML=          ,V2V=        ,V2VUTIL=          ,V2VOPSOFT=          ,V2VOPSOFTP2=          ,V2VCAL1=          ,V2VCAL2=          ,V2VCAL3=          ,V2VXML=          ,EOCAK2UTIL=          ,EOCAIMUTIL=          ,EOCAIMOPSOFT=          ,EOCAIMSYS=          ,EOCAIMDYN=          ,EOCAIMCON=          ,EOCMB=        ,EOCBK1UTIL=          ,EOCBK1OPSOFT=          ,EOCBK1SYS=          ,EOCBK1DYN=          ,EOCBK1CON=          ,EOCBK2UTIL=          ,EOCBK2OPSOFT=          ,EOCBK2SYS=          ,EOCBK2DYN=          ,EOCBK2CON=          ,EOCBIMUTIL=          ,EOCBIMOPSOFT=          ,EOCBIMSYS=          ,EOCBIMDYN=          ,EOCBIMCON=          ,SRRC2RF=        ,SRRC2LR=        ,SRRC2RR=        ,SRRC2CR=        ,SRRC2LRUTIL=          ,SRRC2RRUTIL=          ,EBCDIFF=84910628__,SRRC2RFOP=          ,SRRC2LROP=          ,SRRC2RROP=          ,IRCBLUEOP=          ,IRCRDOFONT=          ,FODM=        ,DMS=        ,DMSUTIL=          ,DMSOPSOFT=          ,DMSCAL=          ,ONSOPSWMODEM=          ,LCM=----****,LCMUTIL=----****__,LCMOPSOFT=----****__,LCMSYS=----****__,LCMHANDS=----****__,LCMOBJECT=----****__,LDWPEDPRO=          ,LDWFRACC=          ,LDWCIB=          ,LDWTABLE=          ,PLCM=        ,V2VCAL4=          ,BECMXML=          ,CDC=        ,CEA=        ,CEAUTIL=          ,DCDCOPSOFT=          ,DCDCUTIL=          ,GAFICMADD=          ,PDIXML=          ,PDPC=        ,PDPCUTIL=          ,RLS=        ,RLSCALN=          ,RLSUTIL=          ,TCMXML=          ,TNB=        ,TNBUTIL=          ,VTDXML=          ,AMPAUDIO=84830260__,AMPANC=84858593__,ESCM=        ,ESCMUTIL=          ,ESCMOPSOFT=          ,ESCMFLASH=          ,ESCMCAL1=          ,ESCMCAL2=          ,ESCMOPSOFTP2=          ,IRCHYBRID=84577939__,IRCSPEECH=84577944__,IRCCOMMON=84845499__,IRCHVAC=84577949__,IRCTELEMAT=84577950__,IRCEQUIP1=84577953__,IRCEQUIP2=84577958__,IRCEQUIP3=84577960__,TIMUTIL=          ,SRRC2CROP=          ,PSD=        ,PSDUTIL=          ,PSDOPSOFT=          ,PSDCAL=          ,DMSP2OP=          ,DMSP3OP=          ,AMM=        ,AMMUTIL=          ,PLCMUTIL=          ,CGMROUT=          ,CGMOBD=          ,CGMCANSEC=13538846__,CGMETHERSEC=13538845__,CGMUTIL2=          ,CGMOPSOFT2=          ,CGMSEC2=          ,CGMCALN2=          ,CGMROUT2=          ,EBCTRLRBRK=          ,EBCTIRETMP=84910631__,VPMHMICONFIG=84808597__,VPMCAMERA=84865106__,SCLOPSOFT=----****__,CSMSDCARD=84663611__,IRCNAVNMAP=          ,TCMCHAR2=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ,VKM=          ,VKMOPSOFT=          ,VKMUTIL=          ,VKMCALN=          ,WCM=13534568,WCMUTIL=13540922__,WCMOPSOFT=13534569__,WCMCHARGING=13534572__,WCMINDOPSW=13534570__,WCMRESOPSW=          ,WCMSYSTEM=          ,WCMCYSEC=          ,WCMBOOT=          ,UPACONFIG=84353985__,ICSOPSOFT=84858591__,ICSCALN=          ,HFPFCALN=          ,HFPFOPSOFT=84873346__,MTCLUTIL=          ,MTCRUTIL=          ,MRCLUTIL=----****__,MRCRUTIL=---*****__,AOSUTIL=84577623__,AOSOPSOFT=84872095__,AOSSYSTEM=84826027__,AOSCALN=84871965__,DMSOPSOFTDLT=          ,DMSCALNDLT=          ,DMSBOOTDLT=          ,DMSFSYS=          ,DMSFSYSDLT=          ,IRCOPSOFT2=          ,ELM=13540881,ELMOPSOFT=13539151__,ELMUTIL=13509113__,ELMBSP1=84543843__,ELMBSP2=84543844__,ELMBSW1=84879685__,ELMBSW2=84879684__,ELMEXTLGT1=84873694__,ELMEXTLGT2=84873693__,ELMWIPER1=84901625__,ELMLOCKING=84543852__,ELMVEHSYS=84543851__,ELMAUX=84965764__,CGM3=        ,CGM3UTIL=          ,CGM3OPSOFT=          ,CGM3SEC=          ,CGM3CALN=          ,CGM3ROUT=          ,CGM3OBD=          ,IPCGAUGE=84855248__,IPCDIMMING=84855249__,IPCBULB=84812485__,IPCALDISP=84924943__,IPCCONS=84812486__,IPCTRANSSEL=84812487__,IPCENGINE=84924945__,IPCHIGHVLTG=84861661__,IPCSUSPMD=84248415__,IPCCRCONT=84248390__,IPCPARKASST=84248417__,IPCCOMPASS=84248418__,IPCCOUNTRY=84248394__,IPCONSTAR=84579592__,IPCACTVSF=84248430__,IPCSTARTSTOP=84812489__,IPCDISPLUNIT=84812490__,IPCLANE=84812491__,IPCINFO=84812492__,IPCPARKBRK=84812493__,IPCSTBELT=84248432__,IPCEXTLIGHT=84812495__,IPCTPM=84579591__,IPCTRACTCONT=84812497__,IPCPS=84812498__,IPCGRAPRO=84248407__,IPCHUD=84861662__,IPCCHIME=84812500__,IPCOPSWCALN=84832162__,EPSCALNAUX=84888075__,EPSSYSAUX=84888074__,EPSSYSAUX2=84888073__,ADIMA=        ,ADIMACALN=          ,ADIMAUTIL=          ,ADIMAOPSOFT=          ,ADIMB=        ,ADIMBUTIL=          ,ADIMBOPSOFT=          ,ADIMBCALN=          ,EPSOPSOFT2=          ,FOPM=        ,IBSG=        ,RESS=        ,CMMA=        ,MCTM=        ,AOS2=        ,BCMPWLFRONT=84855701__,BCMPWLREAR=13519414__,AMPWAV=          ,AMPCHIMECFG=84825174__,EPS2UTIL=          ,TTPM=        ,MTCM2=----****,MTCM2OPSOFT=---*****__,MTCM2CALN=----****__,MTCL2UTIL=          ,MTCR2UTIL=-----***__,KEYFOBPN1=13538850,KEYFOBPN2=13538851,SBZR2=84718352,MCTMUTIL=          ,PDROPSOFT=84884495__,PDRDCALN=84791955__,PDRUTIL=84891719__,PDRHMI=84592907__,PDRVIDEO=84664009__,SCLCALN=----****__,MSMPMOT=13540509__,MSMPCFG=84928162__,SCLOPSOFT2=---*****__,MFCOPSOFT=          ,MFCUTIL=          ,APMOPSOFT=          ,APMCALN=          ,APMUTIL=          ,OBCMUTIL=          ,OBCMOPSOFT=          ,OBCMCALN=          ,OBCMOPSWPS1=          ,OBCMOPSWPS2=          ,OBCMCALNPS1=          ,OBCMCALNPS2=          ,MSMDMOT=13540509__,MSMDCFG=84928159__,AMPDSPOPSOFT=          ,HUDGRAPHCFG=          ,HUDFONTCFG=          ,HUDTRFNAV=          ,HUDCOLADP=          ,HUDENGBRAND=          ,HUDLNDPTR=          ,HUDTRANSCALN=          ,HUDREGION=          ,HUDSTPST=          ,HUDETHER=          ,SIB=13540109,SIBOPSOFT=13540108__,SIBUTIL=13532644__,EOCMACTSFT=          ,EPSCALN2=84888071__,EPSCALN3=84888076__,MRCMR=---*****,MRCMROPSOFT=---*****__,MTCM2R=----****,MTCM2ROPSOFT=----****__,HFPR=        ,HFPROPSOFT=          ,HFPFUTIL=          ,TIMCALN=          ,BCMBSW1=84847920__,BCMBSW2=84863035__,BCMBSP1=84963981__,BCMBSP2=84546485__,BCMOBD1HVAC=84546486__,BCMOBD2HVAC=84903911__,BCMOBD1PPEI=84546483__,BCMOBD2PPEI=84546484__,BCMHVAC1=84898127__,BCMHVAC2=84885617__,BCMHVAC3=84546478__,BCMEXTLGT1=84847926__,BCMEXTLGT2=84863028__,BCMPPEI1=84879689__,BCMPPEI2=84546446__,BCMPEPS1=84972382__,BCMPEPS2=84927120__,BCMHFRC=84580946__,NVMCALN2=          ,MRCM2CALN=----****__,MTCM2RCALN=----****__,FOPMUTIL=          ,FOPMOPSOFT=          ,FOPMCALN=          ,TPMTIREINRR=        ,TPMTIREINLR=        ,PDROPSOFT2=84884496__,VLMHEIGHT=        ,VLMHEIGHTLF=  ,VLMHEIGHTRF=  ,VLMHEIGHTLR=  ,VLMHEIGHTRR=  ,VLM=        ,VLMCALN=          ,VLMOPSOFT=          ,VLMUTIL=          ,AMPWAVCAL=84842594__,GTSBDSOURCE=REMOTE"

    #Validate and Parse build data

    index = BuildData.find(',')
    if index != -1:
        try:
            buildDataLength = int(BuildData[0:index])
        except:
            MainTPassScripting.InterfaceUiLogger("GmTcpHs", "Invalid format for Build Data.  Length field is not an integer : " + BuildData, True, False)
            buildDataLength = 0

        gepicsBuildData = BuildData[index+1:]
        if buildDataLength != len(gepicsBuildData):
            MainTPassScripting.InterfaceUiLogger("GmTcpHs", "Invalid format for Build Data.  Length specified doesn't match length of Gepics data: " + BuildData, True, False)
            
        keyValuePairs = gepicsBuildData.Split(',')
        if keyValuePairs[0] != gepicsBuildData:
            for keyValuePair in keyValuePairs:
                keyarray = keyValuePair.Split('=')
                #TPassLogger.Debug("Option Parsing Script:  keyValuePair = {0}", keyValuePair)
                if len(keyarray) != 2:
                    TPassLogger.Info("Option Parsing Script:  Not Key=Value format  Data = {0}", keyValuePair)
                    continue
                key = keyarray[0].Trim().ToUpper()
                value = keyarray[1].ToUpper()

                # Example ways of setting different IDs
                if (key == "PVI"):
                    primaryId = value
                elif (key == "VIN"):
                    secondaryId = value
                    if (len(value) > 9 and value[9] == 'P'):
                        OptionCodesInBuildData.Add("MY23")
                    if (len(value) > 9 and value[9] == 'R'):
                        OptionCodesInBuildData.Add("MY24")
                    if (len(value) > 9 and value[9] == 'S'):
                        OptionCodesInBuildData.Add("MY25")
                    if (len(value) > 9 and value[9] == 'T'):
                        OptionCodesInBuildData.Add("MY26")
                    if (len(value) > 9 and value[9] == 'V'):
                        OptionCodesInBuildData.Add("MY27")
                    if (len(value) > 9 and value[9] == 'W'):
                        OptionCodesInBuildData.Add("MY28")
                    if (len(value) > 9 and value[9] == 'X'):
                        OptionCodesInBuildData.Add("MY29")
                elif (key == "CSN"):
                    tertiaryId = value
                elif (key == "MD"):
                    quaternaryId = value

                # Populate Option Codes found in broadcasted build data
                if Regex.IsMatch(key, "\\ARP\\d") and value != "":
                    TPassLogger.Debug("Option Parsing Script: RPO Found, RPO = {0}, Value = {1}", key, value)
                    if (value and not value.isspace()):
                        OptionCodesInBuildData.Add(value)
                        TPassLogger.Debug("Option Parsing Script: Added Configured Option Code ({0}) found in build data", value);

                # Populate interested Part Numbers that are in the Broadcasted Build Data
                if key in partNumberTags:
                    if PartNumbers.ContainsKey(key):
                        TPassLogger.Warn("Option Parsing Script: Part Tag ({0}, {1}) found twice in build data.  First occurrence will be used", key, value);
                    else:
                        TPassLogger.Info("Option Parsing Script: Added Part ({0}, {1}) found in build data", key, value);
                        PartNumbers.Add(key, value)                        
            
    else:
        MainTPassScripting.InterfaceUiLogger("GmTcpHs", "Invalid format for Build Data.  Required to be comma delimited : " + BuildData, True, True)
        isSuccess = False

    TPassLogger.Info("Option Parsing Script:  Product Primary ID = {0}", primaryId)
    isSuccess = True

except Exception as inst:
    TPassLogger.Warn("Option Parsing Script:  Exception Occurred :{0}", inst)
    TPassLogger.Warn("Option Parsing Script:  Processing Failed.")
    isSuccess = False
TPassLogger.Info("Option Parsing Script:  Is Success = {0}", isSuccess)

############################################################
# Change History
############################################################
#	Date: 11172022
#	Version: 2.0
#	Change: Added model year option based on VIN 10th digit
#	Date: 10282021
#	Version: 1.0
#	Change: Initial Version
############################################################

